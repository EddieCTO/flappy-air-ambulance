<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Flappy Air Ambulance</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: skyblue;
      text-align: center;
    }

    canvas {
      display: block;
      margin: 0 auto;
      background: linear-gradient(skyblue, #e0f7fa);
      border: 2px solid #333;
    }

    .controls {
      margin: 10px;
    }

    #speedValue {
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>üöÅ Flappy Air Ambulance</h1>
  <canvas id="gameCanvas" width="480" height="640"></canvas>

  <div class="controls">
    <button id="startBtn">Start / Restart</button>
    <label for="speedRange">Speed:</label>
    <input type="range" id="speedRange" min="1" max="5" step="0.5" value="2">
    <span id="speedValue">2</span>
  </div>

  <audio id="flapSound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    const startBtn = document.getElementById("startBtn");
    const speedSlider = document.getElementById("speedRange");
    const speedValue = document.getElementById("speedValue");
    const flapSound = document.getElementById("flapSound");

    let gravity = 0.6;
    let lift = -10;
    let helicopterY = canvas.height / 2;
    let velocity = 0;
    let obstacles = [];
    let gameInterval;
    let speed = 2;
    let helicopterLoaded = false;

    const helicopterImg = new Image();
    helicopterImg.src =
      "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABBCAYAAABrR5bgAAAACXBIWXMAAAsTAAALEwEAmpwYAAADWklEQVR4nO2dTYgVQRSGD1vAcvIAFJfQCnKZsFEtAkygoFFOQOghKSR5A1U0kgPZACUeQQihdGLgzLCae/7WsZ5c/vNzxz1lC5c3J1dXXV1TUpwCagCOjAG9D8R9gvGDKlj3LHyKiA15AJygPYkpcigJ5TqKmlNqIFuKjRyoKepY36K6q5i2Wicf9qvgPAV7WCVqNW6r5QOap+ljUcFVa5hHOAnpRQ9VLfYAVu5gDtbgMgEXutRNqubDEcVbpIA3H0BevvLQVyNO9TwcNXtVNckuoMvER9P+Vk4ZKqnhpOqHrkAo9k64dVK4pLFPfT5j7Rr5/Et3+E9i9Wj+iV5rVzKIL/lJe2XP4sKtz1jU2dE11Ut34JbppYY+x6n9Esm9tRhYz4LgXmGhF+UeY5Sn1s77PMzNLEOl5SOG3YO7pgHy9t5gZ7pAfDdk+SCP2HKe+U3ypF7AZym+1miX1tCM+F5F+c70qPtTfE3MpZ/dKyGHFvPfZKbHre80G4pgU9WYdTfD5Oxf7onZzG8FtuXVi0tdcniHcpnSwkeuVVJYPUM3KXWLqGyXNzr7lbOpOcgD5L6YAx1nn2umxDD1EDP4ElWzvNQ24sF3Z7ls+JvF9V2uXNAYx9c1ZGznbh7fW0ac6pOXTDtGEOYqeBrvb8he1if4HvU1ffBy99lvbq5+4R9QQMnP7tXnryv71HvVp5ZpPXZk5fSvb+yGdD6/v8zVU7MGXddZ41efn2hEP6DNOgJ6s9a8WAAAAAElFTkSuQmCC";
    helicopterImg.onload = () => {
      helicopterLoaded = true;
    };

    function drawHelicopter() {
      if (helicopterLoaded) {
        ctx.drawImage(helicopterImg, 50, helicopterY, 70, 50);
      }
    }

    function drawObstacles() {
      ctx.fillStyle = "green";
      obstacles.forEach((obs) => {
        ctx.fillRect(obs.x, 0, obs.width, obs.top);
        ctx.fillRect(obs.x, obs.top + obs.gap, obs.width, canvas.height);
      });
    }

    function updateObstacles() {
      for (let obs of obstacles) {
        obs.x -= speed;
      }

      if (obstacles.length === 0 || obstacles[obstacles.length - 1].x < canvas.width - 200) {
        let top = Math.random() * (canvas.height / 2);
        obstacles.push({
          x: canvas.width,
          width: 40,
          top: top,
          gap: 150,
        });
      }

      // Remove off-screen obstacles
      if (obstacles.length && obstacles[0].x + obstacles[0].width < 0) {
        obstacles.shift();
      }
    }

    function checkCollision() {
      for (let obs of obstacles) {
        if (
          50 < obs.x + obs.width &&
          50 + 70 > obs.x &&
          (helicopterY < obs.top || helicopterY + 50 > obs.top + obs.gap)
        ) {
          return true;
        }
      }
      return helicopterY + 50 > canvas.height;
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawHelicopter();
      drawObstacles();
    }

    function gameLoop() {
      velocity += gravity;
      helicopterY += velocity;

      updateObstacles();
      draw();

      if (checkCollision()) {
        clearInterval(gameInterval);
        alert("üö® Crash! Game Over.");
      }
    }

    function startGame() {
      helicopterY = canvas.height / 2;
      velocity = 0;
      obstacles = [];
      clearInterval(gameInterval);
      gameInterval = setInterval(gameLoop, 1000 / 60);
    }

    function flap() {
      velocity = lift;
      flapSound.currentTime = 0;
      flapSound.play();
    }

    document.addEventListener("keydown", flap);
    canvas.addEventListener("touchstart", flap);

    startBtn.addEventListener("click", startGame);

    speedSlider.addEventListener("input", () => {
      speed = parseFloat(speedSlider.value);
      speedValue.textContent = speed;
    });
  </script>
</body>
</html>
